---
# Test docs: https://github.com/helm-unittest/helm-unittest/blob/main/DOCUMENT.md
suite: test secret
values:
- ../test_values.yaml
templates:
- secret.yaml
tests:
- it: should work
  set:
    inventory:
      config:
        sources:
          kube:
            type: k8s
            name: my-cluster
            config_source: kubeconfigfile
        gitguardian: null
  asserts:
  - isKind:
      of: Secret
  - matchRegex:
      path: metadata.name
      pattern: -nhi-scout$
  - equal:
      path: data["config.yml"]
      # Base64 encoded content of .Values.inventory.config
      value: "c291cmNlczoKICBrdWJlOgogICAgY29uZmlnX3NvdXJjZToga3ViZWNvbmZpZ2ZpbGUKICAgIG5hbWU6IG15LWNsdXN0ZXIKICAgIHR5cGU6IGs4cw=="
